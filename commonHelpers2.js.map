{"version":3,"file":"commonHelpers2.js","sources":["../src/js/shoppingList.js"],"sourcesContent":["\nimport axios from 'axios';\n\nconst slistGalleryEl = document.querySelector('.slist-card-section');\nconst background = document.querySelector('.slist-demo-thumb');\n\n\n// import { STORAGE_KEY } from \"./local-storage\"          //ключ\nconst STORAGE_KEY = \"local-storage-books\"; \nlet booksIDarray = [];\nconst myStoreKey = \"my-key\";  \nlet myLsArr = [];\n\n//  закидаємо до ЛС обєкт \nfunction loadFromLS(key) {\n  try {\n   \n      const data = localStorage.getItem(key);\n      const result = JSON.parse(data);\n      console.log(result);\n      booksIDarray = result.map(item => item.dataId);   \n      console.log(booksIDarray);\n        return booksIDarray;\n  } catch {console.log('error');\n    showbackground(); }\n         \n};\nconst arrOfId = loadFromLS(STORAGE_KEY);\n\n//  оновлюємо ЛС зі своїм ключем і розміткою\n\nupdateLocalStorage(booksIDarray); \n\nasync function updateLocalStorage(array) {\n   \n  if (array.length === 0 ) {\n    \n    showbackground(); \n  } else {\n      \n      for (const item of array) {\n          console.log(item);\n        const currentBook = await getbook(item);\n        console.log(currentBook);\n        myLsArr.push(currentBook);\n        const updatedJsonString = JSON.stringify(myLsArr);\n\n        // зберігаємо строку JSON в localStorage під ключем\n        localStorage.setItem(myStoreKey, updatedJsonString);\n      }\n    \n    } \n};\n\nasync function getbook(bookId) {\n    const BASE_URL = `https://books-backend.p.goit.global/books/${bookId}`;\n    \n    try {\n        const res = await axios.get(BASE_URL);\n        console.log(res.data);\n        return res.data;\n\n   \n    } catch (error) {\n        console.log('Результатів не знайдено.');\n    };\n\n};\n \n// витягуємо зі свого ЛС та рендеримо\n\nfunction loadFromMYLS(key) {\n  try {\n   \n      const data = localStorage.getItem(key);\n      const result = JSON.parse(data);\n        return result;\n  } catch {console.log('error');\n    showbackground(); }\n         \n};\n\n   \nconst array = loadFromMYLS(myStoreKey);\n\nrenderImages(array);     //рендеримо розмітку\n\n  \nfunction imageTemplate({ _id, book_image,title,list_name,description,author,amazonURL,appleURL}) {\n  return `<div class=\"slist-card-list\">\n            <div class=\"slist-card-item\">\n              <button type=\"button\" data-id=${_id} class=\"slist-del-btn js-slist-del-btn\">\n              </button>\n              <div class=\"slist-card-picture\">\n                <img src=\"${book_image}\" class=\"slist-book-img\" alt=\"books\" />\n              </div>\n              <div class=\"slist-info-container\">\n                <h3 class=\"slist-book-header\">${title}</h3>\n                <h4 class=\"slist-book-category\">${list_name}</h4>\n                <p class=\"slist-book-description\">${description}</p>\n                <h5 class=\"slist-book-autor\">${author}</h5>\n\n                <div class=\"slist-nav\">\n                  <ul class=\"slist-nav-list\">\n                    <li class=\"slist-nav-item\">\n                      <a href=\"${amazonURL}\" class=\"slist-nav-link\">\n\n                      <img class=\"img-amazone logo\" src=\"./img/amazonicon.png\" alt=\"app\">\n                     </a>\n\n                    </li>\n\n                    <li class=\"slist-nav-item\">\n                      <a href=\"${appleURL}\" class=\"slist-nav-link\"><img class=\"img-app logo\" src=\"./img/appbook.png\" alt=\"app\"></a>\n                      \n                    </li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n          </div>`};\n\n\n\nfunction imagesTemplate(array) {\n  return array.map(imageTemplate).join('');\n      \n};\n\nfunction renderImages(array) {\n   \n  if (array === null || array === [] || !myStoreKey) {\n    \n    showbackground(); \n  } else {\n   const markup = imagesTemplate(array);\n  slistGalleryEl.innerHTML = markup;\n    slistGalleryEl.addEventListener('click', onBtnClick);\n    } // ставимо слухача на форму\n};\n\n\n\n async function onBtnClick(e) {\n   if (e.target.nodeName === 'BUTTON') {\n    console.log(e.target.dataset.id);\n  \n    let bookId = (e.target.dataset.id);//знаходимо по ід на кнопку повішену\n   \n    const jsonString = localStorage.getItem(myStoreKey);\n    let currentArray = JSON.parse(jsonString);\n    localStorage.removeItem(myStoreKey)\n     currentArray.splice(\n      currentArray.findIndex(item => item.id === bookId),\n      1\n    );\n    console.log(currentArray);\n    if (currentArray.length < 1) {\n      localStorage.removeItem(myStoreKey);\n      slistGalleryEl.innerHTML = \"\";\n      showbackground(); \n    } else {\n    const updatedJsonString = JSON.stringify(currentArray);\n      localStorage.setItem(myStoreKey, updatedJsonString);\n      renderImages(currentArray);\n    };\n        \n      \n  };\n\n\n};\n\nfunction hidebackground() {\n    background.classList.add('is-hidden');\n};\n\n\nfunction showbackground() {\n  background.classList.remove('is-hidden');\n\n};\n\n\n"],"names":["slistGalleryEl","background","STORAGE_KEY","booksIDarray","myStoreKey","myLsArr","loadFromLS","key","data","result","item","showbackground","updateLocalStorage","array","currentBook","getbook","updatedJsonString","bookId","BASE_URL","res","axios","loadFromMYLS","renderImages","imageTemplate","_id","book_image","title","list_name","description","author","amazonURL","appleURL","imagesTemplate","markup","onBtnClick","e","jsonString","currentArray"],"mappings":"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"}