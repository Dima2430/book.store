import"./assets/sidebar-c1c3702c.js";import{a as h,i as M}from"./assets/vendor-169f9f98.js";const w=document.querySelector(".loader");function T(){w.style.display="flex"}function N(){w.style.display="none"}const O=document.querySelector(".best-books-gallery"),R=h.create({baseURL:"https://books-backend.p.goit.global/books"});async function E(){try{T();const o=await R.get("/top-books");return N(),o.data}catch{M.error({position:"topRight",message:"Sorry, no books were found. Please try again."})}}E();function J({list_name:o,books:t}){return`
    <li class="book-category-item">
      <p class="book-category">${o}</p>
      <ul class="top-books">
        ${t.map(e=>`
              <li class="book-card" data-id="${e._id}">
              <div class="book-card-hover">
                <img class="book-cover" src="${e.book_image}" alt="${e.title}"/>
                <div class="view-more">
                <p class="view-more-text">quick view</p>
                </div>
                </div>
                <div class="book-descr">
                <h2 class="book-name">${e.title}</h2>
                <h3 class="book-author">${e.author}</h3>
                </div>
              </li>
            `).join("")}
      </ul>
      <button class="book-card-btn" type="button" data-category="${o}">see more</button>
    </li>
  `}async function _(){const o=await E();let t="";for(let i of o)t+=J(i);const s=` <h1 class="collection-title">Best Sellers <span>Books</span></h1>${`<ul class="top-books-all">${t}</ul>`}`;O.innerHTML=s}_();const j=document.querySelector(".signup-btn"),q=document.querySelector(".form-container"),z=document.querySelector(".close-btn");j.addEventListener("click",()=>{q.classList.add("visible")});z.addEventListener("click",()=>{q.classList.remove("visible")});const p="local-storage-books";let a,k=a;document.addEventListener("DOMContentLoaded",function(){const o=document.getElementById("container"),t=document.getElementById("myModal"),e=document.getElementById("shoppingListBtn"),s=document.getElementById("closeModalBtn"),i=document.getElementById("notification"),d=document.querySelector(".modal-content");function g(c){const n=localStorage.getItem(p);let l;try{l=n?JSON.parse(n):[]}catch(r){return console.log("Помилка при парсингу JSON:",r),!1}return l.some(r=>r.dataId===c)}o.addEventListener("click",function(c){const n=c.target.closest(".book-card"),l=c.target.closest(".book-card-category");n?(a=n.dataset.id,k=a,console.log(a),L(a)):l&&(a=l.dataset.id,k=a,console.log(a),L(a))}),s.addEventListener("click",function(){B()}),window.addEventListener("click",function(c){c.target===t&&B()}),e.addEventListener("click",function(){u()});function u(){e.dataset.bookId,e.textContent==="Add to shopping list"?(m(),b("Congratulations! You have added the book to the shopping list. To delete, press the button “Remove from the shopping list”."),S()):(f(),v(),$(),e.textContent="Add to shopping list")}async function m(){const c=localStorage.getItem(p);let n;try{n=c?JSON.parse(c):[]}catch(r){console.log("Помилка при парсингу JSON:",r);return}const l={dataId:a};if(n.every(r=>r.dataId!==l.dataId)){n.push(l);const r=JSON.stringify(n);try{localStorage.setItem(p,r)}catch(x){console.log("Помилка при зберіганні даних:",x)}}e.textContent="Remove from the shopping list"}async function $(c){const n=JSON.parse(localStorage.getItem(p))||[],l=n.findIndex(r=>r.dataId===k);l!==-1?(n.splice(l,1),localStorage.setItem(p,JSON.stringify(n)),e.textContent="Add to shopping list"):console.log("Book with dataId:",k,"not found in localStorage")}function b(c){i.innerHTML=`<span>${c}</span>`,i.style.display="block"}function f(){i.style.display="none"}function S(){d.classList.add("expanded")}function v(){d.classList.remove("expanded")}function L(c){Y(c);const n=g(a),l=document.getElementById("shoppingListBtn");n?(l.textContent="Remove from shopping list",b("Congratulations! You have added the book to the shopping list. To delete, press the button “Remove from the shopping list”."),S()):(l.textContent="Add to shopping list",f(),v()),t.style.display="block",document.body.style.overflow="hidden"}function B(){t.style.display="none",document.body.style.overflow="auto"}});async function Y(o){const t=`https://books-backend.p.goit.global/books/${o}`;try{const s=(await h.get(t)).data;return H(s),s}catch{console.log("Результатів не знайдено.")}}function H(o){const t=document.querySelector(".book_name"),e=document.querySelector(".author"),s=document.querySelector(".description"),i=document.querySelector(".img_modal"),d=document.querySelector('.links a[name="Amazon"]'),g=document.querySelector('.links a[name="Apple Books"]');if(t.textContent=o.title,e.textContent=o.author,s.textContent=o.description,i.src=o.book_image,d){const u=o.buy_links.find(m=>m.name==="Amazon");u&&(d.href=u.url)}if(g){const u=o.buy_links.find(m=>m.name==="Apple Books");u&&(g.href=u.url)}}const y=document.querySelector(".scroll-btn"),U=o=>{window.scrollTo({top:o.offsetTop,behavior:"smooth"})},C=()=>{const o=document.querySelector(".collection-title");o?(y.addEventListener("click",()=>{U(o)}),window.addEventListener("scroll",()=>{(window.scrollY||window.pageYOffset)>o.offsetTop?y.classList.add("show-scroll-btn"):y.classList.remove("show-scroll-btn")})):setTimeout(C,100)};C();document.querySelector("#toggle");document.querySelector("body");document.querySelectorAll("p");document.querySelectorAll("h1");document.querySelectorAll("h2");document.querySelectorAll("h3");document.querySelectorAll("h4");document.querySelectorAll("h5");document.querySelectorAll("h6");document.querySelectorAll("a");document.querySelectorAll(".book-card-btn");const D=document.querySelector(".best-books-gallery"),G=document.querySelectorAll(".sidebar-categories-link");G.forEach(o=>{o.addEventListener("click",function(t){t.preventDefault();const e=this.textContent.trim();P(e)})});async function P(o){try{const t=await I(o);A(t,o)}catch(t){console.error("Error loading books:",t)}}D.addEventListener("click",W);function W(o){if(o.target.nodeName!=="BUTTON")return;const t=o.target;try{if(t.matches("button[data-category]")){const e=t.dataset.category;I(e).then(s=>{A(s,e)}).catch(s=>{})}}catch(e){console.log(e)}}async function I(o){try{return(await h.get(`https://books-backend.p.goit.global/books/category?category=${o}`)).data}catch(t){console.log(t);return}}function K({_id:o,book_image:t,title:e,author:s}){return`
    <li class="book-card-category" data-id="${o}">
      <div class="book-thumb">
        <img class="book-cover-cat" src="${t}" alt="${e}"/>
        <div class="view-more view-more-cat">
        <p class="view-more-text">quick view</p>
        </div>
        </div>
        <div class="book-descr">
        <h2 class="book-namne-cat">${e}</h2>
        <h3 class="book-author">${s}</h3>
        </div>
      </li>`}function A(o,t){const s=`<ul class="category-books-cat">${o.map(K).join("")}</ul>`,i=`<h2 class="collection-title">${F(t)} <span>${Q(t)}</span></h2> ${s}`,d=document.querySelector(".best-books-gallery");d.innerHTML=i}function F(o){let t=o.split(" ");return t.pop(),t.join(" ")}function Q(o){let t=o.trim().split(" ");return t[t.length-1]}
//# sourceMappingURL=commonHelpers.js.map
